<app-page-breadcrumb [pageInfo]="pageInfo" [isModal]="false"></app-page-breadcrumb>
<div class="row clearfix">
    <div class="col-lg-12 col-md-12 col-sm-12">
        <div class="card">
            <div class="body">
                <div class="input-group col-sm-12 mb-3">
                    <div class="list-group cursor-pointer" style="flex-direction: row; width: 100%;"
                        (click)="openSearchModal()">
                        <div
                            class="list-group-item cursor-pointer list-group-item-action flex-column align-items-start ">
                            <label class="cursor-pointer">
                                <div class="d-flex w-100 justify-content-between">
                                    <h5 class="mb-1">Select Staff</h5>
                                </div>
                                <small>To select the Staff for Transfer</small>
                            </label>
                        </div>
                    </div>
                </div>
                <ng-container *ngIf="staffData?.id">
                    <tab-head #tab [segment]="segment" [type]="'MODIFICATION_SUBMIT'" [initial]="segment.BASIC" (onSubmitEvent)="goBack()"
                        [getModificationPayload]="apiPayloadModify" [data]="staffData"
                        [checkValidSegment]="checkSegmentStatus">
                        <ng-template #tabBody let-active="active">
                            <div class="tab-pane show active" [hidden]="active != segment.BASIC">
                                <ng-container *ngIf="staffData?.id">
                                    <ng-container *ngTemplateOutlet="profile;context : {data:staffData}"></ng-container>
                                    <app-staff-exp-gems #staffExpGems [mode]="'ACTIVE'" [type]="'TRANSFER'"
                                        [staffId]="staffData?.staff_emp_id"
                                        [config]="{title : 'Active Position',isView:false,showOnUpdate :true,updateOnly:true}">
                                    </app-staff-exp-gems>
                                    <app-staff-exp-gems (onChangeEvent)="onChange($event)" #officeForm [mode]="'ACTIVE'"
                                        [config]="{title : 'Transfer To Position',isView:false,updateOnly:false,formData :officeFormData  ,dynValidator:[],cols:[{colName : 'is_primary', title : 'Primary'}]}">
                                    </app-staff-exp-gems>

                                </ng-container>
                            </div>

                            <div class="tab-pane show active" [hidden]="active != segment.ADDRESS">
                                <app-address #address [isPage]="true" [submitted]="submitted"
                                    title="Address"></app-address>
                            </div>

                            <div class="tab-pane show active" [hidden]="active != segment.SPOUSE">
                                <span class="error" *ngIf="spouseError">{{spouseError}}</span>
                                <span *ngIf="spouseLoading"><i class="pi pi-spin pi-spinner"></i> fetching Spouse
                                    Details...</span>
                                <ng-container *ngIf="spouseData.id && !spouseLoading">
                                    <ng-container
                                        *ngTemplateOutlet="profile;context : {data:spouseData}"></ng-container>
                                    <app-staff-exp-gems #spouseExpGems [mode]="'ACTIVE'" [type]="'TRANSFER'"
                                        [staffId]="spouseData?.staff_emp_id"
                                        [config]="{title : 'Active Position',isView:false,showOnUpdate :true,updateOnly:true}">
                                    </app-staff-exp-gems>
                                    <app-staff-exp-gems (onChangeEvent)="onChange($event)" #spouseOfficeForm
                                        [mode]="'ACTIVE'"
                                        [config]="{title : 'Transfer To Position',isView:false,updateOnly:false,formData :officeFormData ,dynValidator:[],cols:[{colName : 'is_primary', title : 'Primary'}]}">
                                    </app-staff-exp-gems>
                                </ng-container>
                            </div>
                        </ng-template>
                    </tab-head>
                    <ng-container [ngTemplateOutlet]="tab?.tabFooter"></ng-container>
                </ng-container>
            </div>
        </div>
    </div>
    <!-- <app-page-loader [loading]="dataLoading"></app-page-loader> -->
    <!-- <div class="row clearfix align-center">
        <div class="col-12" *ngIf="statusErrorMsg">
            <div class="alert alert-danger" role="alert">
                {{statusErrorMsg | titlecase}}
            </div>
        </div>
        
    </div> -->
</div>
<ng-template #profile let-data="data">
    <div class="body ribbon">
        <div class="ribbon-box" class="{{+data.gender ==1 ? 'green' : 'pink'}}" style="top:-2px">
            {{data?.genderName}}</div>
        <div class="media">
            <img class="rounded mr-3 img-thumbnail" style="width: 70px;" [src]="data?.profile_img_path" imageLoad>
            <div class="media-body">
                <h5 class="m-0">{{data?.name}}</h5>
                <p class="text-muted mb-0">{{data?.deName}}</p>
                <p class="text-muted mb-0">{{data?.staff_emp_id}}</p>
            </div>
        </div>
        <div class="col-12">
            <info-view [sourceData]="data" [mapData]="staffShowData"></info-view>
        </div>
    </div>
</ng-template>